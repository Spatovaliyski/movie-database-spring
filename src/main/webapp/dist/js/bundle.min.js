"use strict";jQuery(document).ready(function(e){e("#login-form").submit(function(t){t.preventDefault(),e.ajax({url:"/login",method:"POST",data:{username:e("#username").val(),password:e("#password").val()},success:function(t){window.location.replace(t),console.log(t)},fail:function(t){console.log(t),window.location.href="error.html"}})}),e("#updateuser").submit(function(t){t.preventDefault(),console.log("test"),e.ajax({url:"/updateUser",method:"POST",data:{username:e("#username").val(),avatar:e("#avatar").val(),oldPassword:e("#oldPassword").val(),newPassword:e("#newPassword").val(),repeatPassword:e("#repeatPassword").val(),email:e("#email").val()},success:function(t){window.location.replace(t),console.log(t)},fail:function(t){console.log(t),window.location.href="error.html"}})})}),jQuery("document").ready(function(n){n("body").addClass("loaded"),console.log("Scripts loaded!");var i,s,t,e,a,o,c="ca3d69ee336e43d8099727f0d7ce3859";function l(){n.ajax({url:"/whoAmI",method:"GET",complete:function(t){switch(t.status){case 200:t.responseJSON;break;case 401:window.location.href="index.html"}},fail:function(){window.location.href="index.html"}})}n.ajax({url:"/whoAmI",method:"GET",complete:function(t){200===t.status&&(s=t.responseJSON)}}),n("#logout").on("click",function(){n.ajax({url:"logout",method:"POST",complete:function(t){401==t.status&&alert("ERROR!"),window.location.href="index.html"}})}),n(".add-to-favorite").click(function(){var t;n(this).hasClass("is-favorite")||(t=n(".movie-id").val(),n.ajax({url:"/favorites/add",method:"POST",data:{movieId:t},success:function(t){console.log(t),t.includes("Error:")?alert(t):n(".add-to-favorite").addClass("is-favorite")},fail:function(){alert("Something went terribly wrong!!!")}}))}),n(".comments-form .btn").click(function(t){var e,a;t.preventDefault(),t=n(".movie-id").val(),e=n("#comment").val(),a=n("#rating option:selected").text(),n.ajax({url:"/comment/post",method:"POST",data:{commentarea:e,movieId:t,rating:parseInt(a)},success:function(t){t.includes("Error:")?alert(t):n(".movie-comments-list").append('\n\t\t\t\t\t\t<li class="comment-item">\n\t\t\t\t\t\t\t<picture class="comment-author-avatar"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png" alt=""></picture>\n\t\t\t\t\t\t\t<div class="comment-author-meta">\n\t\t\t\t\t\t\t\t<h4 class="comment-author">Me</h4>\n\t\t\t\t\t\t\t\t<span class="comment-rating">Rating: '.concat(a,'/10</span>\n\t\t\t\t\t\t\t\t<div class="comment-copy">').concat(e,"</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t")),n("#comment").empty()},fail:function(){alert("Something went terribly wrong!!!")}})}),n("body").hasClass("page-movie")?(a=new URL(document.location).searchParams.get("id"),i=a,n.ajax({url:"https://api.themoviedb.org/3/movie/"+i+"?api_key="+c,contentType:"application/json",dataType:"json",success:function(t){t.vote_average;var e=new Date(t.release_date);n(".single-movie-poster").append('<img src="https://image.tmdb.org/t/p/w1920_and_h800_multi_faces/'.concat(t.poster_path,'">')),n(".single-movie-thumbnail").append('<picture><img src="https://image.tmdb.org/t/p/w440_and_h660_face/'.concat(t.poster_path,'"></picture>')),n(".single-movie-title").prepend("".concat(t.title)+"<span class='single-movie-date'>("+e.getFullYear()+")</span>"),n(".single-movie-overview").append("".concat(t.overview));var a,o=[];jQuery.each(t.genres,function(t,e){return o.push(String(e.name).split(",")[0])}),n(".single-movie-details .runtime").prepend(t.runtime),n(".single-movie-details .genres").append(o.join(", ")),n(".movie-id").val(i),a=n(".movie-id").val(),n.ajax({url:"/favorites/all",method:"GET",contentType:"application/json",dataType:"json",complete:function(t){jQuery.each(t.responseJSON,function(t,e){e.movieId==a&&e.user.id==s&&n(".add-to-favorite").addClass("is-favorite")})},fail:function(){console.log("Failed getting favorite movies")}})}})):(t="2020",e="",n(".movie-item").remove(),n.ajax({url:"https://api.themoviedb.org/3/discover/movie?api_key="+c+"&year="+t+"&with_genres="+e,contentType:"application/json",dataType:"json",success:function(t){jQuery.each(t.results,function(t,e){var a=e.vote_average<=7?"dist/images/thumbs-down-solid.svg":"dist/images/thumbs-up-solid.svg";n(".movies-list").append('\n\t\t\t\t\t\t<li class="movie-item">\n\t\t\t\t\t\t\t<a class="movie-item-link" href="movie.html?id='.concat(e.id,'">\n\t\t\t\t\t\t\t\t<div class="movie-rating"><span>').concat(e.vote_average,'</span><img class="movie-recommendation" src="').concat(a,'" alt=""/></div>\n\t\t\t\t\t\t\t\t<aside class="movie-thumbnail">\n\t\t\t\t\t\t\t\t\t<picture><img src="https://image.tmdb.org/t/p/w440_and_h660_face/').concat(e.poster_path,'"></picture>\n\t\t\t\t\t\t\t\t</aside>\n\t\t\t\t\t\t\t\t<div class="movie-meta">\n\t\t\t\t\t\t\t\t\t<p class="movie-release-date">').concat(e.release_date,'</p>\n\t\t\t\t\t\t\t\t\t<h2 class="movie-title">').concat(e.title,'</h2>\n\t\t\t\t\t\t\t\t\t<div class="movie-description">').concat(e.overview,"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"))})}})),n("body").hasClass("page-login")||(n("body").hasClass("page-error")?setTimeout(function(){l()},2e3):n("body").hasClass("page-register")||l()),n("body").hasClass("page-movie")&&(o=new URL(document.location).searchParams.get("id"),n.ajax({url:"/comment/all",method:"GET",contentType:"application/json",dataType:"json",complete:function(t){jQuery.each(t.responseJSON,function(t,e){e.movieId==o&&n(".movie-comments-list").append('\n\t\t\t\t\t\t\t<li class="comment-item">\n\t\t\t\t\t\t\t\t<picture class="comment-author-avatar"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png" alt=""></picture>\n\t\t\t\t\t\t\t\t<div class="comment-author-meta">\n\t\t\t\t\t\t\t\t\t<h4 class="comment-author">'.concat(e.user.username,'</h4>\n\t\t\t\t\t\t\t\t\t<span class="comment-rating">Rating: ').concat(e.rating,'/10</span>\n\t\t\t\t\t\t\t\t\t<div class="comment-copy">').concat(e.comment,"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"))})},fail:function(){console.log("Failed getting comments")}}))});